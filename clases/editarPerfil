<?php
session_start();

include "clases/BD.php";
include "clases/usuario.php";

$bd= new BD;
$usuario=$bd-> traerUsuario($_SESSION["user_id"]);

if($_POST){
 include ' clases/Validador.php'
 $validador? new Validador();

//validador  y al final  si no hay errores actualizar el usuario
$errorMail = "";
$errorPassword = "";
$errorChequear = "";
$usuarioEscrito = "";
$errores = false;

if($_POST){

	 //traigo los usuarios de la base de datos
    $jsonLogin = file_get_contents("usuarios.json");
    //lo convierto a php
    $jsonLogin = json_decode($jsonLogin, true);
    if($_POST["email"] == ""){
        $errorMail = "El usuario es obligatorio.";
        $errores = true;
    }else if(strlen($_POST["email"]) < 2){
        $usuarioEscrito = $_POST["email"];
        $errorMail = "El nombre debe tener al menos dos caracteres.";
    }
    if($_POST["password"] == ""){
        $errorPassword = "La contraseÃ±a es obligatoria.";
        $usuarioEscrito = $_POST["email"];
        $errores = true;
    }

    if (!$errore) {
      // actualizar el usuario
      $bd->actualizarUsuario($_POST['full_name'],$_POST['email']);
      //rediriir
      echo "Usuario actualizado.";exit;


    }
}

 ?>
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Editar Perfil</title>
    <link href="css/styles.css" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  </head>
  <body>
    <h1>Editar Perfil</h1>
  <form class="" action="" method="post">
    nombre completo:
    <input type="text" name="full_name" value="<?=$usuario['nombre']?>">
    <br>
    Email:
    <input type="text" name="email" value="<?=$usuario['email']?>">
    <br><br>
    <button type="submit" name="button">Guardar cambios</button>

  </form>
</html>
