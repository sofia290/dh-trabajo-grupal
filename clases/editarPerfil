<?php
session_start();

include "clases/BD.php";
include "clases/usuario.php";

$bd= new BD;
$usuario=$bd-> traerUsuario($_SESSION["user_id"]);

if($_POST){
 include ' clases/Validador.php'
 $validador? new Validador();
 if($_POST){
  //include_once 'clases/Usuario.php';
  include_once 'clases/Validador.php';
  
  
  //validacion
  $errores = false;
  $validador = new Validador();
  $errorNombre = "";
  $errorApellido = "";
  $errorEmail = "";
  $errorFecha = "";
  $errorUsuario = "";
  $errorPassword = "";
  if($validador->estaVacio($_POST["nombre"])){
    $errorNombre = "El nombre es obligatorio";
    $errores = true;
  };
  if($validador->estaVacio($_POST["apellido"])){
    $errorApellido = "El apellido es obligatorio";
    $errores = true;
  };
  if($validador->estaVacio($_POST["email"])){
    $errorEmail = "El email es obligatorio";
    $errores = true;
  }
  if($validador->tieneFormatoEmail($_POST["email"]) == false){
    $errores = true;
  }
  if($validador->estaVacio($_POST["fecha-de-nacimiento"])){
    $errorFecha = "La fecha de nacimiento es obligatoria";
    $errores = true;
  };
  if($validador->estaVacio($_POST["username"])){
    $errorUsuario = "El nombre de usuario es obligatorio";
    $errores = true;
  };
  if($validador->estaVacio($_POST["password"])){
    $errorPassword = "La contraseÃ±a es obligatoria";
    $errores = true;
  };
}

//validador  y al final  si no hay errores actualizar el usuario
$errorMail = "";
$errorPassword = "";
$errorChequear = "";
$usuarioEscrito = "";
$errores = false;

    if (!$errore) {
      // actualizar el usuario
      $bd->actualizarUsuario($_POST['full_name'],$_POST['email']);
      //rediriir
      echo "Usuario actualizado.";exit;
    }
}

 ?>
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Editar Perfil</title>
    <link href="css/styles.css" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  </head>
  <body>
    <h1>Editar Perfil</h1>
  <form class="" action="" method="post">
    nombre completo:
    <input type="text" name="full_name" value="<?=$usuario['nombre']?>">
    <br>
    Email:
    <input type="text" name="email" value="<?=$usuario['email']?>">
    <br><br>
    <button type="submit" name="button">Guardar cambios</button>

  </form>
</html>
